import logging
from datetime import datetime
import azure.functions as func

from intraday_alert import run_intraday_alert  # core loop logic

def main(timer: func.TimerRequest) -> None:
    utc_now = datetime.utcnow().isoformat()
    logging.info(f"[FINNHUBLISTENER] ⏰ Timer triggered at {utc_now} UTC")

    try:
        run_intraday_alert()
        logging.info("[FINNHUBLISTENER] ✅ PR monitor executed successfully.")
    except Exception as e:
        logging.error(f"[FINNHUBLISTENER] ❌ Error during execution: {e}")
